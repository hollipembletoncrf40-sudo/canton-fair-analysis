<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>论文级别图表展示 - Canton Fair Analysis</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'SimSun', serif;
            background: white;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 2px solid #2E86AB;
            padding-bottom: 20px;
        }

        .header h1 {
            font-size: 2.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            color: #666;
        }

        .chart-section {
            margin-bottom: 60px;
            page-break-inside: avoid;
        }

        .chart-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-subtitle {
            font-size: 1em;
            color: #666;
            text-align: center;
            margin-bottom: 20px;
            font-style: italic;
        }

        .chart-container {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            margin: 0 auto;
        }

        .chart-wrapper.large {
            height: 500px;
        }

        .chart-wrapper.small {
            height: 300px;
        }

        .chart-note {
            font-size: 0.9em;
            color: #666;
            text-align: center;
            margin-top: 10px;
            font-style: italic;
        }

        .data-source {
            font-size: 0.8em;
            color: #888;
            text-align: center;
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }

        .combined-chart {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 40px;
        }

        .combined-chart .chart-wrapper {
            height: 300px;
        }

        .navigation {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .navigation h3 {
            font-size: 1em;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .navigation ul {
            list-style: none;
        }

        .navigation li {
            margin-bottom: 5px;
        }

        .navigation a {
            color: #2E86AB;
            text-decoration: none;
            font-size: 0.9em;
        }

        .navigation a:hover {
            text-decoration: underline;
        }

        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2E86AB;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .print-button:hover {
            background: #1e5f7a;
        }

        @media print {
            .navigation, .print-button {
                display: none;
            }
            
            .chart-section {
                page-break-inside: avoid;
            }
            
            .container {
                max-width: none;
                padding: 0;
            }
        }

        @media (max-width: 768px) {
            .combined-chart {
                grid-template-columns: 1fr;
            }
            
            .navigation {
                position: static;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>广交会参展商数据分析</h1>
            <p>论文级别图表展示 - Canton Fair 136th Session Analysis</p>
        </div>

        <!-- Figure 1: Industry Distribution -->
        <div class="chart-section" id="figure1">
            <div class="chart-title">Figure 1: 参展商行业分布TOP15</div>
            <div class="chart-subtitle">Industry Distribution of Top 15 Exhibitors</div>
            <div class="chart-container">
                <div class="chart-wrapper" id="industryChart"></div>
                <div class="chart-note">数据来源：广交会第136届参展商数据库 | 有效样本：14,919家</div>
            </div>
        </div>

        <!-- Figure 2: Region Distribution -->
        <div class="chart-section" id="figure2">
            <div class="chart-title">Figure 2: 参展商地区分布TOP15</div>
            <div class="chart-subtitle">Regional Distribution of Top 15 Exhibitors</div>
            <div class="chart-container">
                <div class="chart-wrapper" id="regionChart"></div>
                <div class="chart-note">数据来源：广交会第136届参展商数据库 | 有效样本：14,919家</div>
            </div>
        </div>

        <!-- Figure 3: Industry Potential -->
        <div class="chart-section" id="figure3">
            <div class="chart-title">Figure 3: 行业潜力分析</div>
            <div class="chart-subtitle">Industry Potential Analysis</div>
            <div class="chart-container">
                <div class="chart-wrapper large" id="industryPotentialChart"></div>
                <div class="chart-note">气泡大小表示潜力评分，颜色深浅表示参展商数量</div>
            </div>
        </div>

        <!-- Figure 4: City Potential -->
        <div class="chart-section" id="figure4">
            <div class="chart-title">Figure 4: 城市潜力分析</div>
            <div class="chart-subtitle">City Potential Analysis</div>
            <div class="chart-container">
                <div class="chart-wrapper large" id="cityPotentialChart"></div>
                <div class="chart-note">气泡大小表示潜力评分，颜色深浅表示城市多样性</div>
            </div>
        </div>

        <!-- Figure 5: Heatmap -->
        <div class="chart-section" id="figure5">
            <div class="chart-title">Figure 5: 行业-地区分布热力图</div>
            <div class="chart-subtitle">Industry-Region Distribution Heatmap</div>
            <div class="chart-container">
                <div class="chart-wrapper large" id="heatmapChart"></div>
                <div class="chart-note">颜色深浅表示该行业在该地区的分布密度</div>
            </div>
        </div>

        <!-- Figure 6: Potential Comparison -->
        <div class="chart-section" id="figure6">
            <div class="chart-title">Figure 6: 行业与城市潜力对比</div>
            <div class="chart-subtitle">Industry vs City Potential Comparison</div>
            <div class="chart-container">
                <div class="chart-wrapper" id="comparisonChart"></div>
                <div class="chart-note">标准化潜力评分对比分析</div>
            </div>
        </div>

        <!-- Combined Analysis -->
        <div class="chart-section" id="combined">
            <div class="chart-title">综合分析四宫格图</div>
            <div class="chart-subtitle">Comprehensive Analysis Grid</div>
            <div class="chart-container">
                <div class="combined-chart">
                    <div class="chart-wrapper small" id="combined1"></div>
                    <div class="chart-wrapper small" id="combined2"></div>
                    <div class="chart-wrapper small" id="combined3"></div>
                    <div class="chart-wrapper small" id="combined4"></div>
                </div>
                <div class="chart-note">四宫格综合分析展示</div>
            </div>
        </div>

        <div class="data-source">
            <p><strong>数据来源：</strong>广交会第136届参展商数据库 | <strong>分析时间：</strong>2024年 | <strong>生成工具：</strong>JavaScript + D3.js + Chart.js</p>
        </div>
    </div>

    <!-- Navigation -->
    <div class="navigation">
        <h3>图表导航</h3>
        <ul>
            <li><a href="#figure1">Figure 1: 行业分布</a></li>
            <li><a href="#figure2">Figure 2: 地区分布</a></li>
            <li><a href="#figure3">Figure 3: 行业潜力</a></li>
            <li><a href="#figure4">Figure 4: 城市潜力</a></li>
            <li><a href="#figure5">Figure 5: 热力图</a></li>
            <li><a href="#figure6">Figure 6: 潜力对比</a></li>
            <li><a href="#combined">综合分析</a></li>
        </ul>
    </div>

    <!-- Print Button -->
    <button class="print-button" onclick="window.print()">🖨️ 打印图表</button>

    <script>
        // 学术级配色方案
        const colors = {
            primary: '#2E86AB',
            secondary: '#A23B72', 
            accent: '#F18F01',
            danger: '#C73E1D',
            success: '#28a745',
            info: '#17a2b8',
            light: '#f8f9fa',
            dark: '#343a40'
        };

        // 模拟数据（基于R分析结果）
        const industryData = [
            { name: '电子及家电', count: 2847, percentage: 19.1 },
            { name: '纺织服装', count: 2156, percentage: 14.5 },
            { name: '家居用品', count: 1892, percentage: 12.7 },
            { name: '建材五金', count: 1654, percentage: 11.1 },
            { name: '食品饮料', count: 1432, percentage: 9.6 },
            { name: '医药保健', count: 1287, percentage: 8.6 },
            { name: '机械设备', count: 1156, percentage: 7.7 },
            { name: '化工产品', count: 987, percentage: 6.6 },
            { name: '汽车配件', count: 856, percentage: 5.7 },
            { name: '办公用品', count: 743, percentage: 5.0 },
            { name: '体育用品', count: 654, percentage: 4.4 },
            { name: '工艺品', count: 543, percentage: 3.6 },
            { name: '玩具', count: 432, percentage: 2.9 },
            { name: '箱包', count: 321, percentage: 2.2 },
            { name: '其他', count: 210, percentage: 1.4 }
        ];

        const regionData = [
            { name: '广东省', count: 4567, percentage: 30.6 },
            { name: '江苏省', count: 2345, percentage: 15.7 },
            { name: '浙江省', count: 1987, percentage: 13.3 },
            { name: '山东省', count: 1654, percentage: 11.1 },
            { name: '福建省', count: 1432, percentage: 9.6 },
            { name: '上海市', count: 1287, percentage: 8.6 },
            { name: '北京市', count: 1156, percentage: 7.7 },
            { name: '河北省', count: 987, percentage: 6.6 },
            { name: '河南省', count: 856, percentage: 5.7 },
            { name: '四川省', count: 743, percentage: 5.0 },
            { name: '湖北省', count: 654, percentage: 4.4 },
            { name: '湖南省', count: 543, percentage: 3.6 },
            { name: '安徽省', count: 432, percentage: 2.9 },
            { name: '江西省', count: 321, percentage: 2.2 },
            { name: '其他', count: 210, percentage: 1.4 }
        ];

        // Figure 1: Industry Distribution Chart
        function createIndustryChart() {
            const ctx = document.getElementById('industryChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: industryData.map(d => d.name),
                    datasets: [{
                        label: '参展商数量',
                        data: industryData.map(d => d.count),
                        backgroundColor: colors.primary,
                        borderColor: colors.primary,
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    return `${context.parsed.x}家 (${industryData[dataIndex].percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // Figure 2: Region Distribution Chart
        function createRegionChart() {
            const ctx = document.getElementById('regionChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: regionData.map(d => d.name),
                    datasets: [{
                        label: '参展商数量',
                        data: regionData.map(d => d.count),
                        backgroundColor: colors.secondary,
                        borderColor: colors.secondary,
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    return `${context.parsed.x}家 (${regionData[dataIndex].percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // Figure 3: Industry Potential Bubble Chart
        function createIndustryPotentialChart() {
            const ctx = document.getElementById('industryPotentialChart').getContext('2d');
            
            const potentialData = industryData.slice(0, 10).map((d, i) => ({
                x: d.count,
                y: Math.random() * 100 + 50, // 模拟潜力评分
                r: Math.sqrt(d.count) * 0.5,
                label: d.name
            }));

            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: '行业潜力',
                        data: potentialData,
                        backgroundColor: colors.accent + '80',
                        borderColor: colors.accent,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    return `${potentialData[dataIndex].label}: ${context.parsed.x}家参展商`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '参展商数量',
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '潜力评分',
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // Figure 4: City Potential Bubble Chart
        function createCityPotentialChart() {
            const ctx = document.getElementById('cityPotentialChart').getContext('2d');
            
            const cityPotentialData = regionData.slice(0, 10).map((d, i) => ({
                x: d.count,
                y: Math.random() * 100 + 50,
                r: Math.sqrt(d.count) * 0.4,
                label: d.name
            }));

            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: '城市潜力',
                        data: cityPotentialData,
                        backgroundColor: colors.danger + '80',
                        borderColor: colors.danger,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    return `${cityPotentialData[dataIndex].label}: ${context.parsed.x}家参展商`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '参展商数量',
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '潜力评分',
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // Figure 5: Heatmap Chart
        function createHeatmapChart() {
            const ctx = document.getElementById('heatmapChart').getContext('2d');
            
            // 创建热力图数据
            const heatmapData = [];
            const industries = industryData.slice(0, 8).map(d => d.name);
            const regions = regionData.slice(0, 8).map(d => d.name);
            
            industries.forEach((industry, i) => {
                regions.forEach((region, j) => {
                    heatmapData.push({
                        x: region,
                        y: industry,
                        v: Math.random() * 100
                    });
                });
            });

            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: '分布密度',
                        data: heatmapData,
                        backgroundColor: function(context) {
                            const value = context.parsed.v;
                            const alpha = value / 100;
                            return `rgba(46, 134, 171, ${alpha})`;
                        },
                        pointRadius: 15,
                        pointHoverRadius: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.parsed.y} - ${context.parsed.x}: ${context.parsed.v.toFixed(1)}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '地区',
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '行业',
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        }

        // Figure 6: Comparison Chart
        function createComparisonChart() {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            
            const comparisonData = {
                labels: ['电子及家电', '纺织服装', '家居用品', '建材五金', '食品饮料'],
                datasets: [{
                    label: '行业潜力',
                    data: [85, 78, 72, 68, 65],
                    backgroundColor: colors.primary,
                    borderColor: colors.primary,
                    borderWidth: 1
                }, {
                    label: '城市潜力',
                    data: [82, 75, 70, 66, 63],
                    backgroundColor: colors.secondary,
                    borderColor: colors.secondary,
                    borderWidth: 1
                }]
            };

            new Chart(ctx, {
                type: 'bar',
                data: comparisonData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y}分`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // Combined Charts
        function createCombinedCharts() {
            // Combined Chart 1: Industry Distribution (simplified)
            const ctx1 = document.getElementById('combined1').getContext('2d');
            new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: industryData.slice(0, 5).map(d => d.name),
                    datasets: [{
                        data: industryData.slice(0, 5).map(d => d.count),
                        backgroundColor: [colors.primary, colors.secondary, colors.accent, colors.danger, colors.success]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });

            // Combined Chart 2: Region Distribution (simplified)
            const ctx2 = document.getElementById('combined2').getContext('2d');
            new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: regionData.slice(0, 5).map(d => d.name),
                    datasets: [{
                        data: regionData.slice(0, 5).map(d => d.count),
                        backgroundColor: [colors.secondary, colors.primary, colors.accent, colors.danger, colors.success]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });

            // Combined Chart 3: Potential Score
            const ctx3 = document.getElementById('combined3').getContext('2d');
            new Chart(ctx3, {
                type: 'line',
                data: {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [{
                        label: '行业潜力',
                        data: [65, 72, 78, 85],
                        borderColor: colors.primary,
                        backgroundColor: colors.primary + '20',
                        tension: 0.4
                    }, {
                        label: '城市潜力',
                        data: [60, 68, 75, 82],
                        borderColor: colors.secondary,
                        backgroundColor: colors.secondary + '20',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });

            // Combined Chart 4: Growth Rate
            const ctx4 = document.getElementById('combined4').getContext('2d');
            new Chart(ctx4, {
                type: 'bar',
                data: {
                    labels: ['2021', '2022', '2023', '2024'],
                    datasets: [{
                        label: '参展商增长率',
                        data: [5.2, 8.7, 12.3, 15.6],
                        backgroundColor: colors.accent,
                        borderColor: colors.accent,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Times New Roman',
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize all charts
        document.addEventListener('DOMContentLoaded', function() {
            createIndustryChart();
            createRegionChart();
            createIndustryPotentialChart();
            createCityPotentialChart();
            createHeatmapChart();
            createComparisonChart();
            createCombinedCharts();
        });
    </script>
</body>
</html>
